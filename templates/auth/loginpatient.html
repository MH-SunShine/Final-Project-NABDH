<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Login Patient</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/styleregist.css') }}">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600&display=swap" rel="stylesheet">
</head>
<body>
    <div class="main-container">
        <a class="navbar-brand fixed-top" href="{{ url_for('index') }}">
            <img src="{{ url_for('static', filename='images/white-logo.png') }}" alt="Logo">
        </a>

        <div class="left">
            <p>Access your health records, appointments, and more.<br>Log in now!</p>
        </div>
        <div class="right">
            <div class="form-container">    
                <h2>One of Us ?</h2>
                <form id="login-form">
                    <i class="fa fa-envelope"></i>
                    <label for="email">E-mail</label>
                    <input type="email" name="email" id="email" class="form-control" 
                           placeholder="ex : nabdhhealth@gmail.com" required 
                           aria-label="Email address">

                    <i class="fa fa-lock"></i>
                    <label for="password">Password</label>
                    <input type="password" name="password" id="password" class="form-control" 
                           required aria-label="Password">

                    <div id="login-error" class="alert alert-danger mt-3" style="display: none;"></div>

                    <button type="submit" class="btn btn-success mt-3" id="login-button">
                        <span class="button-text">Log In</span>
                        <span class="spinner-border spinner-border-sm d-none" role="status" aria-hidden="true"></span>
                    </button>

                    <p class="text-center">
                        Don't have an account? <a href="{{ url_for('patient_bp.signup_page') }}">Sign Up</a>
                    </p>
                </form>
            </div>
        </div>
    </div>
    
    <!-- Load scripts at the end of body -->
    <script>
        // Debug script loading
        console.log('Page loaded');
        document.addEventListener('DOMContentLoaded', () => {
            console.log('DOM fully loaded');
            
            // Check if we were redirected from dashboard
            const urlParams = new URLSearchParams(window.location.search);
            if (urlParams.get('session_expired')) {
                const errorDiv = document.getElementById('login-error');
                if (errorDiv) {
                    errorDiv.textContent = 'Your session has expired. Please log in again.';
                    errorDiv.style.display = 'block';
                }
            }
        });
    </script>
    <script src="{{ url_for('static', filename='js/app.js') }}"></script>
    <script src="{{ url_for('static', filename='js/auth.js') }}"></script>
</body>
</html>
